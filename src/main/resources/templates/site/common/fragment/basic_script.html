<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="common-util">
<script th:inline="javascript">
$(document).ready(function() {
	const header = $('meta[name="_csrf_header"]').attr('content');
	const token = $('meta[name="_csrf"]').attr('content');
	ajaxUtil.setup(header, token);
});

// 날짜 형식 자동 변환
const checkDateFormat = function(obj) {
	if(event == null || event == undefined) return;
	
	// @see DELETE 키버튼이 눌리지 않은 경우에만 실행
	if (event.keyCode != 8) {

		// @see 숫자와 하이픈(-)기호의 값만 존재하는 경우 실행
		if (obj.value.replace(/[0-9 \-]/g, '').length == 0) {

			// @see 하이픈(-)기호를 제거한다.
			let number = obj.value.replace(/[^0-9]/g, '');
			let ymd = '';

			// @see 문자열의 길이에 따라 Year, Month, Day 앞에 하이픈(-)기호를 삽입한다.
			if (number.length < 4) {
				return number;
			} else if (number.length < 6) {
				ymd += number.substr(0, 4);
				ymd += '-';
				ymd += number.substr(4);
			} else {
				ymd += number.substr(0, 4);
				ymd += '-';
				ymd += number.substr(4, 2);
				ymd += '-';
				ymd += number.substr(6);
			}

			obj.value = ymd;

		} else {
			//@see 숫자와 하이픈(-)기호 이외의 모든 값은 삭제한다.
			obj.value = obj.value.replace(/[^0-9 ^\-]/g, '');
			return false;
		}
	} else {
		return false;
	}
}

// 숫자 형식 자동 변환
const checkNumberFormat = function(obj) {
	if(event == null || event == undefined) return;
	if(obj == null || obj == undefined) return;
	
	obj.value = obj.value.replace(/[^0-9]/g, '');
}

//전화번호 형식 자동 변환
const checkPhoneNoFormat = function(obj) {
	if(event == null || event == undefined) return;
	
	// @see DELETE 키버튼이 눌리지 않은 경우에만 실행
	if (event.keyCode != 8) {
		//@see 숫자와 하이픈(-)기호 이외의 모든 값은 삭제한다.
		obj.value = obj.value.replace(/[^0-9^\-]/g, '');
		return false;
	} else {
		return false;
	}
};

//사업자번호 형식 자동 변경
const checkCmpNoFormat = function(obj) {
	if(event == null || event == undefined) return;
	
	// @see DELETE 키버튼이 눌리지 않은 경우에만 실행
	if (event.keyCode != 8) {

		// @see 숫자와 하이픈(-)기호의 값만 존재하는 경우 실행
		if (obj.value.replace(/[0-9 \-]/g, '').length == 0) {

			// @see 하이픈(-)기호를 제거한다.
			let number = obj.value.replace(/[^0-9]/g, '');
			let comNo = '';

			if (number.length < 3) {
				return number;
			} else if (number.length < 5) {
				comNo += number.substr(0, 3);
				comNo += '-';
				comNo += number.substr(3);
			} else {
				comNo += number.substr(0, 3);
				comNo += '-';
				comNo += number.substr(3, 2);
				comNo += '-';
				comNo += number.substr(5);
			}

			obj.value = comNo;

		} else {
			//@see 숫자와 하이픈(-)기호 이외의 모든 값은 삭제한다.
			obj.value = obj.value.replace(/[^0-9 ^\-]/g, '');
			return false;
		}
	} else {
		return false;
	}
}

//사업자번호 유효성 검사
const checkCmpNo = function (cmpNo) {
	const valueMap = cmpNo.replace(/-/gi, '').split('').map(function(item) {
		return parseInt(item, 10);
	});

	if (valueMap.length === 10) {
		const multiply = new Array(1, 3, 7, 1, 3, 7, 1, 3, 5);
		let checkSum = 0;

		for (let i = 0; i < multiply.length; ++i) {
			checkSum += multiply[i] * valueMap[i];
		}

		checkSum += parseInt((multiply[8] * valueMap[8]) / 10, 10);
		return Math.floor(valueMap[9]) === (10 - (checkSum % 10));
	}

	return false;
}

//법인번호 유효성 검사
const checkCorpRegNo = function (value) {
	const re = /-/g;
	value = value.replace('-', '');
	
	if (value.length != 13) {
		return false;
	}
	
	/* const arr_regno = value.split('');
	const arr_wt = new Array(1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2);
	let iSum_regno = 0;
	let iCheck_digit = 0;
	for (let i = 0; i < 12; i++) {
		iSum_regno += eval(arr_regno[i]) * eval(arr_wt[i]);
	}
	iCheck_digit = 10 - (iSum_regno % 10);
	iCheck_digit = iCheck_digit % 10;
	if (iCheck_digit != arr_regno[12]) {
		return false;
	} */
	return true;
}

// 법인등록번호 형식 자동 변경
const checkCorpRegNoFormat = function(obj) {
	if(event == null || event == undefined) return;
	
	// @see DELETE 키버튼이 눌리지 않은 경우에만 실행
	if (event.keyCode != 8) {

		// @see 숫자와 하이픈(-)기호의 값만 존재하는 경우 실행
		if (obj.value.replace(/[0-9 \-]/g, '').length == 0) {

			// @see 하이픈(-)기호를 제거한다.
			let number = obj.value.replace(/[^0-9]/g, '');
			let corpRegNo = '';

			if (number.length < 6) {
				return number;
			} else {
				corpRegNo += number.substr(0, 6);
				corpRegNo += '-';
				corpRegNo += number.substr(6);
			}

			obj.value = corpRegNo;

		} else {
			//@see 숫자와 하이픈(-)기호 이외의 모든 값은 삭제한다.
			obj.value = obj.value.replace(/[^0-9 ^\-]/g, '');
			return false;
		}
	} else {
		return false;
	}
}

//한전기업번호 유효성 검사
/* const checkkpscmNo = function (kpscmNo) {
	const valueMap = kpscmNo.replace(/-/gi, '').split('').map(function(item) {
		return parseInt(item, 10);
	});

	if (valueMap.length === 10) {
		const multiply = new Array(1, 3, 7, 1, 3, 7, 1, 3, 5);
		let checkSum = 0;

		for (let i = 0; i < multiply.length; ++i) {
			checkSum += multiply[i] * valueMap[i];
		}

		checkSum += parseInt((multiply[8] * valueMap[8]) / 10, 10);
		return Math.floor(valueMap[9]) === (10 - (checkSum % 10));
	}

	return false;
} */

// 날짜를 문자열로 변환 (yyyy-MM-dd))
const getDate = function(orgDate) {
	const date = new Date(orgDate);
	const y = date.getFullYear();
	const m = ('0' + (date.getMonth() + 1)).slice(-2);
	const d = ('0' + date.getDate()).slice(-2);

	return y + "-" + m + "-" + d;
};

// 이메일 유효성 체크
const checkEmail = function(userEmail) {
	const emailRegExp = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
	if (userEmail.match(emailRegExp) == null) {
		return false;
	}
	return true;
};

// UUID 생성
const uuid = function () {
	function s4() {
		return ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);
	}
	return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
}
</script>
</th:block>
</html>